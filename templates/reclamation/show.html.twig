{% extends 'base.html.twig' %}

{% block title %}R√©clamation{% endblock %}

{% block body %}
<div class="container mt-5">
    <h1 class="mb-4 text-center">D√©tails de la R√©clamation</h1>

    <table class="table table-bordered table-striped shadow-sm">
        <thead>
            <tr>
                <th class="table-success">ID</th>
                <th>{{ reclamation.id }}</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <th class="table-secondary">Cat√©gorie</th>
                <td>{{ reclamation.categorie }}</td>
            </tr>
            <tr>
                <th class="table-secondary">Statut</th>
                <td>{{ reclamation.statut }}</td>
            </tr>
            <tr>
                <th class="table-secondary">Description</th>
                <td>{{ reclamation.description }}</td>
            </tr>
            <tr>
                <th class="table-secondary">Date de cr√©ation</th>
                <td>{{ reclamation.dateCreation ? reclamation.dateCreation|date('Y-m-d H:i') : '' }}</td>
            </tr>
        </tbody>
    </table>

    <!-- Bouton √âcouter pour la r√©clamation -->
    <button class="btn btn-info mb-3" onclick="lireReclamation()">üéß √âcouter la r√©clamation</button>

    <div class="mt-5">
        <h3 class="text-primary">R√©ponses de l'administration</h3>

        {% if reponses is empty %}
            <div class="alert alert-info mt-3">Aucune r√©ponse n‚Äôa encore √©t√© donn√©e.</div>
        {% else %}
            <ul class="list-group mt-3">
                {% for reponse in reponses %}
                    <li class="list-group-item">
                        <strong>Le {{ reponse.dateCreation|date('d/m/Y H:i') }} :</strong><br>
                        {{ reponse.contenu }}
                    </li>
                {% endfor %}
            </ul>
        {% endif %}
    </div>

    <!-- Bouton √âcouter pour les r√©ponses -->
    <button class="btn btn-info mb-3 mt-3" onclick="lireReponses()">üéß √âcouter les r√©ponses</button>

    <div class="d-flex justify-content-between mt-4">
        <a href="{{ path('app_reclamation_index') }}" class="btn btn-primary">Retour √† la liste</a>
        <a href="{{ path('app_reclamation_edit', {'id': reclamation.id}) }}" class="btn btn-warning">Modifier</a>
    </div>

    <div class="mt-4">
        {{ include('reclamation/_delete_form.html.twig') }}
    </div>
</div>

<!-- Script JavaScript pour la synth√®se vocale -->
<script>
    function lireReclamation() {
        const texte = `
            R√©clamation num√©ro {{ reclamation.id }},
            Cat√©gorie : {{ reclamation.categorie }},
            Statut : {{ reclamation.statut }},
            Description : {{ reclamation.description }},
            Date de cr√©ation : {{ reclamation.dateCreation ? reclamation.dateCreation|date('d/m/Y H:i') : 'non d√©finie' }}
        `;

        const synth = window.speechSynthesis;
        const utterance = new SpeechSynthesisUtterance(texte);
        utterance.lang = 'fr-FR';
        synth.speak(utterance);
    }

    function lireReponses() {
        let texteReponses = "R√©ponses de l'administration : ";
        
        {% for reponse in reponses %}
            texteReponses += "Le {{ reponse.dateCreation|date('d/m/Y H:i') }} : {{ reponse.contenu }}. ";
        {% endfor %}

        if (texteReponses === "R√©ponses de l'administration : ") {
            texteReponses += "Aucune r√©ponse n'a √©t√© donn√©e.";
        }

        const synth = window.speechSynthesis;
        const utterance = new SpeechSynthesisUtterance(texteReponses);
        utterance.lang = 'fr-FR';
        synth.speak(utterance);
    }
</script>
{% endblock %}
